BeforeExecute
-- Informix.DB2 Informix

DELETE FROM
	TestMerge1

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer -- Int32
SET     @Field1 = NULL
DECLARE @Field2 Integer -- Int32
SET     @Field2 = NULL
DECLARE @Field4 Integer -- Int32
SET     @Field4 = NULL
DECLARE @Id Integer(4) -- Int32
SET     @Id = 1

INSERT INTO TestMerge1
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer(4) -- Int32
SET     @Field1 = 2
DECLARE @Field2 Integer -- Int32
SET     @Field2 = NULL
DECLARE @Field4 Integer -- Int32
SET     @Field4 = NULL
DECLARE @Id Integer(4) -- Int32
SET     @Id = 2

INSERT INTO TestMerge1
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer -- Int32
SET     @Field1 = NULL
DECLARE @Field2 Integer(4) -- Int32
SET     @Field2 = 3
DECLARE @Field4 Integer(4) -- Int32
SET     @Field4 = 203
DECLARE @Id Integer(4) -- Int32
SET     @Id = 3

INSERT INTO TestMerge1
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer(4) -- Int32
SET     @Field1 = 5
DECLARE @Field2 Integer(4) -- Int32
SET     @Field2 = 6
DECLARE @Field4 Integer -- Int32
SET     @Field4 = NULL
DECLARE @Id Integer(4) -- Int32
SET     @Id = 4

INSERT INTO TestMerge1
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix

DELETE FROM
	TestMerge2

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer -- Int32
SET     @Field1 = NULL
DECLARE @Field2 Integer(4) -- Int32
SET     @Field2 = 3
DECLARE @Field4 Integer -- Int32
SET     @Field4 = NULL
DECLARE @Id Integer(4) -- Int32
SET     @Id = 3

INSERT INTO TestMerge2
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer(4) -- Int32
SET     @Field1 = 5
DECLARE @Field2 Integer(4) -- Int32
SET     @Field2 = 7
DECLARE @Field4 Integer(4) -- Int32
SET     @Field4 = 214
DECLARE @Id Integer(4) -- Int32
SET     @Id = 4

INSERT INTO TestMerge2
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer(4) -- Int32
SET     @Field1 = 10
DECLARE @Field2 Integer(4) -- Int32
SET     @Field2 = 4
DECLARE @Field4 Integer -- Int32
SET     @Field4 = NULL
DECLARE @Id Integer(4) -- Int32
SET     @Id = 5

INSERT INTO TestMerge2
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix
DECLARE @Field1 Integer -- Int32
SET     @Field1 = NULL
DECLARE @Field2 Integer -- Int32
SET     @Field2 = NULL
DECLARE @Field4 Integer(4) -- Int32
SET     @Field4 = 216
DECLARE @Id Integer(4) -- Int32
SET     @Id = 6

INSERT INTO TestMerge2
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	@Field1,
	@Field2,
	@Field4,
	@Id
)

BeforeExecute
-- Informix.DB2 Informix

MERGE INTO TestMerge1 Target
USING (
	SELECT
		t1.Id,
		t1.Field3 as Field1,
		t1.Field4 as Field2,
		t1.Id + t1.Id + t1.Id as Field4
	FROM
		TestMerge2 t1
) Source
(
	Id, 
	Field1, 
	Field2, 
	Field4
)
ON (Target.Id = Source.Id - 1)

WHEN NOT MATCHED THEN
INSERT
(
	Field1,
	Field2,
	Field4,
	Id
)
VALUES
(
	Source.Field1,
	Source.Field2,
	Source.Field4,
	Source.Id
)

BeforeExecute
-- Informix.DB2 Informix

SELECT
	t1.Field1,
	t1.Field2,
	t1.Field3,
	t1.Field4,
	t1.Field5,
	t1.Id
FROM
	TestMerge1 t1
ORDER BY
	t1.Id

