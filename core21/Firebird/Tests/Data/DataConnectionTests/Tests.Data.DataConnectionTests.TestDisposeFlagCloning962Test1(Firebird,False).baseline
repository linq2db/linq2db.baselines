BeforeExecute
-- Firebird

CREATE TABLE "Categories"
(
	"CategoryID"   Int                                     NOT NULL,
	"CategoryName" VarChar(255) CHARACTER SET UNICODE_FSS  NOT NULL,
	"Description"  VarChar(255) CHARACTER SET UNICODE_FSS,

	CONSTRAINT "PK_Categories" PRIMARY KEY ("CategoryID")
)

BeforeExecute
-- Firebird

CREATE GENERATOR "GIDENTITY_Categories"

BeforeExecute
-- Firebird

CREATE TRIGGER "TIDENTITY_Categories" FOR "Categories"
BEFORE INSERT POSITION 0
AS BEGIN
	NEW."CategoryID" = GEN_ID("GIDENTITY_Categories", 1);
END

BeforeExecute
-- Firebird

INSERT INTO "Categories"
(
	"CategoryName",
	"Description"
)
SELECT 'Name 1','Desc 1' FROM rdb$database UNION ALL
SELECT 'Name 2','Desc 2' FROM rdb$database

BeforeExecute
-- Firebird

CREATE TABLE "Products"
(
	"CategoryID"      Int,
	"ProductID"       Int                                     NOT NULL,
	"ProductName"     VarChar(255) CHARACTER SET UNICODE_FSS  NOT NULL,
	"QuantityPerUnit" VarChar(255) CHARACTER SET UNICODE_FSS,

	CONSTRAINT "PK_Products" PRIMARY KEY ("ProductID")
)

BeforeExecute
-- Firebird

CREATE GENERATOR "GIDENTITY_Products"

BeforeExecute
-- Firebird

CREATE TRIGGER "TIDENTITY_Products" FOR "Products"
BEFORE INSERT POSITION 0
AS BEGIN
	NEW."ProductID" = GEN_ID("GIDENTITY_Products", 1);
END

BeforeExecute
-- Firebird

INSERT INTO "Products"
(
	"CategoryID",
	"ProductName",
	"QuantityPerUnit"
)
SELECT 1,'Prod 1','q 1' FROM rdb$database UNION ALL
SELECT 1,'Prod 2','q 2' FROM rdb$database UNION ALL
SELECT 3,'Prod 3','q 3' FROM rdb$database UNION ALL
SELECT 3,'Prod 4','q 4' FROM rdb$database UNION ALL
SELECT 1,'Prod 5','q 5' FROM rdb$database UNION ALL
SELECT 1,'Prod 6','q 6' FROM rdb$database

BeforeExecute
-- Firebird

SELECT
	"lw_Category"."CategoryID",
	"detail"."CategoryID",
	"detail"."ProductID",
	"detail"."ProductName",
	"detail"."QuantityPerUnit"
FROM
	"Categories" "lw_Category"
		INNER JOIN "Products" "detail" ON "lw_Category"."CategoryID" = "detail"."CategoryID"

BeforeExecute
-- Firebird

SELECT
	"t1"."CategoryID",
	"t1"."CategoryName",
	"t1"."Description"
FROM
	"Categories" "t1"

BeforeExecute
-- Firebird

EXECUTE BLOCK AS BEGIN
	EXECUTE STATEMENT 'DROP TRIGGER "TIDENTITY_Products"';
	EXECUTE STATEMENT 'DROP GENERATOR "GIDENTITY_Products"';
	EXECUTE STATEMENT 'DROP TABLE "Products"';
END

BeforeExecute
-- Firebird

EXECUTE BLOCK AS BEGIN
	EXECUTE STATEMENT 'DROP TRIGGER "TIDENTITY_Categories"';
	EXECUTE STATEMENT 'DROP GENERATOR "GIDENTITY_Categories"';
	EXECUTE STATEMENT 'DROP TABLE "Categories"';
END

