BeforeExecute
-- DB2 DB2.LUW DB2LUW

MERGE INTO "LinqDataTypes" "Target"
USING (
	SELECT
		"t1".ID,
		"t1"."BigIntValue",
		"t1"."BoolValue",
		"t1"."DateTimeValue",
		"t1"."DateTimeValue2",
		"t1"."GuidValue",
		"t1"."IntValue",
		"t1"."MoneyValue",
		"t1"."SmallIntValue",
		"t1"."StringValue"
	FROM
		"LinqDataTypes" "t1"
) "Source"
(
	ID, 
	"BigIntValue", 
	"BoolValue", 
	"DateTimeValue", 
	"DateTimeValue2", 
	"GuidValue", 
	"IntValue", 
	"MoneyValue", 
	"SmallIntValue", 
	"StringValue"
)
ON ("Target".ID = "Source".ID)

WHEN MATCHED THEN
UPDATE
SET
	"Target"."BigIntValue" = "Source"."BigIntValue",
	"Target"."BoolValue" = "Source"."BoolValue",
	"Target"."DateTimeValue" = "Source"."DateTimeValue",
	"Target"."DateTimeValue2" = "Source"."DateTimeValue2",
	"Target"."GuidValue" = "Source"."GuidValue",
	"Target"."IntValue" = "Source"."IntValue",
	"Target"."MoneyValue" = "Source"."MoneyValue",
	"Target"."SmallIntValue" = "Source"."SmallIntValue",
	"Target"."StringValue" = "Source"."StringValue"

WHEN NOT MATCHED THEN
INSERT
(
	"BigIntValue",
	"BoolValue",
	"DateTimeValue",
	"DateTimeValue2",
	"GuidValue",
	ID,
	"IntValue",
	"MoneyValue",
	"SmallIntValue",
	"StringValue"
)
VALUES
(
	"Source"."BigIntValue",
	"Source"."BoolValue",
	"Source"."DateTimeValue",
	"Source"."DateTimeValue2",
	"Source"."GuidValue",
	"Source".ID,
	"Source"."IntValue",
	"Source"."MoneyValue",
	"Source"."SmallIntValue",
	"Source"."StringValue"
)

