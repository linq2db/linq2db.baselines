BeforeExecute
-- SqlServer.2005

IF (OBJECT_ID(N'[Booking]', N'U') IS NOT NULL)
	DROP TABLE [Booking]

BeforeExecute
-- SqlServer.2005

IF (OBJECT_ID(N'[Booking]', N'U') IS NULL)
	CREATE TABLE [Booking]
	(
		[BookingID]   Int      NOT NULL,
		[ServiceDate] DateTime NOT NULL,
		[Value]       Int      NOT NULL
	)

BeforeExecute
-- SqlServer.2005

INSERT INTO [Booking]
(
	[BookingID],
	[ServiceDate],
	[Value]
)
SELECT 1,CAST('2020-02-27T17:54:55.123' AS DATETIME),1 UNION ALL
SELECT 2,CAST('2020-02-26T17:54:55.123' AS DATETIME),2 UNION ALL
SELECT 3,CAST('2020-02-28T17:54:55.123' AS DATETIME),3 UNION ALL
SELECT 4,CAST('2020-02-27T17:54:55.123' AS DATETIME),4 UNION ALL
SELECT 5,CAST('2020-02-26T17:54:55.123' AS DATETIME),5 UNION ALL
SELECT 6,CAST('2020-02-28T17:54:55.123' AS DATETIME),6 UNION ALL
SELECT 7,CAST('2020-02-27T17:54:55.123' AS DATETIME),7 UNION ALL
SELECT 8,CAST('2020-02-26T17:54:55.123' AS DATETIME),8 UNION ALL
SELECT 9,CAST('2020-02-28T17:54:55.123' AS DATETIME),9 UNION ALL
SELECT 10,CAST('2020-02-27T17:54:55.123' AS DATETIME),10 UNION ALL
SELECT 11,CAST('2020-02-26T17:54:55.123' AS DATETIME),11 UNION ALL
SELECT 12,CAST('2020-02-28T17:54:55.123' AS DATETIME),12 UNION ALL
SELECT 13,CAST('2020-02-27T17:54:55.123' AS DATETIME),13 UNION ALL
SELECT 14,CAST('2020-02-26T17:54:55.123' AS DATETIME),14 UNION ALL
SELECT 15,CAST('2020-02-28T17:54:55.123' AS DATETIME),15 UNION ALL
SELECT 16,CAST('2020-02-27T17:54:55.123' AS DATETIME),16 UNION ALL
SELECT 17,CAST('2020-02-26T17:54:55.123' AS DATETIME),17 UNION ALL
SELECT 18,CAST('2020-02-28T17:54:55.123' AS DATETIME),18 UNION ALL
SELECT 19,CAST('2020-02-27T17:54:55.123' AS DATETIME),19 UNION ALL
SELECT 20,CAST('2020-02-26T17:54:55.123' AS DATETIME),20 UNION ALL
SELECT 21,CAST('2020-02-28T17:54:55.123' AS DATETIME),21 UNION ALL
SELECT 22,CAST('2020-02-27T17:54:55.123' AS DATETIME),22 UNION ALL
SELECT 23,CAST('2020-02-26T17:54:55.123' AS DATETIME),23 UNION ALL
SELECT 24,CAST('2020-02-28T17:54:55.123' AS DATETIME),24 UNION ALL
SELECT 25,CAST('2020-02-27T17:54:55.123' AS DATETIME),25 UNION ALL
SELECT 26,CAST('2020-02-26T17:54:55.123' AS DATETIME),26 UNION ALL
SELECT 27,CAST('2020-02-28T17:54:55.123' AS DATETIME),27 UNION ALL
SELECT 28,CAST('2020-02-27T17:54:55.123' AS DATETIME),28 UNION ALL
SELECT 29,CAST('2020-02-26T17:54:55.123' AS DATETIME),29 UNION ALL
SELECT 30,CAST('2020-02-28T17:54:55.123' AS DATETIME),30 UNION ALL
SELECT 31,CAST('2020-02-27T17:54:55.123' AS DATETIME),31 UNION ALL
SELECT 32,CAST('2020-02-26T17:54:55.123' AS DATETIME),32 UNION ALL
SELECT 33,CAST('2020-02-28T17:54:55.123' AS DATETIME),33 UNION ALL
SELECT 34,CAST('2020-02-27T17:54:55.123' AS DATETIME),34 UNION ALL
SELECT 35,CAST('2020-02-26T17:54:55.123' AS DATETIME),35 UNION ALL
SELECT 36,CAST('2020-02-28T17:54:55.123' AS DATETIME),36 UNION ALL
SELECT 37,CAST('2020-02-27T17:54:55.123' AS DATETIME),37 UNION ALL
SELECT 38,CAST('2020-02-26T17:54:55.123' AS DATETIME),38 UNION ALL
SELECT 39,CAST('2020-02-28T17:54:55.123' AS DATETIME),39 UNION ALL
SELECT 40,CAST('2020-02-27T17:54:55.123' AS DATETIME),40 UNION ALL
SELECT 41,CAST('2020-02-26T17:54:55.123' AS DATETIME),41 UNION ALL
SELECT 42,CAST('2020-02-28T17:54:55.123' AS DATETIME),42 UNION ALL
SELECT 43,CAST('2020-02-27T17:54:55.123' AS DATETIME),43 UNION ALL
SELECT 44,CAST('2020-02-26T17:54:55.123' AS DATETIME),44 UNION ALL
SELECT 45,CAST('2020-02-28T17:54:55.123' AS DATETIME),45 UNION ALL
SELECT 46,CAST('2020-02-27T17:54:55.123' AS DATETIME),46 UNION ALL
SELECT 47,CAST('2020-02-26T17:54:55.123' AS DATETIME),47 UNION ALL
SELECT 48,CAST('2020-02-28T17:54:55.123' AS DATETIME),48 UNION ALL
SELECT 49,CAST('2020-02-27T17:54:55.123' AS DATETIME),49 UNION ALL
SELECT 50,CAST('2020-02-26T17:54:55.123' AS DATETIME),50 UNION ALL
SELECT 51,CAST('2020-02-28T17:54:55.123' AS DATETIME),51 UNION ALL
SELECT 52,CAST('2020-02-27T17:54:55.123' AS DATETIME),52 UNION ALL
SELECT 53,CAST('2020-02-26T17:54:55.123' AS DATETIME),53 UNION ALL
SELECT 54,CAST('2020-02-28T17:54:55.123' AS DATETIME),54 UNION ALL
SELECT 55,CAST('2020-02-27T17:54:55.123' AS DATETIME),55 UNION ALL
SELECT 56,CAST('2020-02-26T17:54:55.123' AS DATETIME),56 UNION ALL
SELECT 57,CAST('2020-02-28T17:54:55.123' AS DATETIME),57 UNION ALL
SELECT 58,CAST('2020-02-27T17:54:55.123' AS DATETIME),58 UNION ALL
SELECT 59,CAST('2020-02-26T17:54:55.123' AS DATETIME),59 UNION ALL
SELECT 60,CAST('2020-02-28T17:54:55.123' AS DATETIME),60 UNION ALL
SELECT 61,CAST('2020-02-27T17:54:55.123' AS DATETIME),61 UNION ALL
SELECT 62,CAST('2020-02-26T17:54:55.123' AS DATETIME),62 UNION ALL
SELECT 63,CAST('2020-02-28T17:54:55.123' AS DATETIME),63 UNION ALL
SELECT 64,CAST('2020-02-27T17:54:55.123' AS DATETIME),64 UNION ALL
SELECT 65,CAST('2020-02-26T17:54:55.123' AS DATETIME),65 UNION ALL
SELECT 66,CAST('2020-02-28T17:54:55.123' AS DATETIME),66 UNION ALL
SELECT 67,CAST('2020-02-27T17:54:55.123' AS DATETIME),67 UNION ALL
SELECT 68,CAST('2020-02-26T17:54:55.123' AS DATETIME),68 UNION ALL
SELECT 69,CAST('2020-02-28T17:54:55.123' AS DATETIME),69 UNION ALL
SELECT 70,CAST('2020-02-27T17:54:55.123' AS DATETIME),70 UNION ALL
SELECT 71,CAST('2020-02-26T17:54:55.123' AS DATETIME),71 UNION ALL
SELECT 72,CAST('2020-02-28T17:54:55.123' AS DATETIME),72 UNION ALL
SELECT 73,CAST('2020-02-27T17:54:55.123' AS DATETIME),73 UNION ALL
SELECT 74,CAST('2020-02-26T17:54:55.123' AS DATETIME),74 UNION ALL
SELECT 75,CAST('2020-02-28T17:54:55.123' AS DATETIME),75 UNION ALL
SELECT 76,CAST('2020-02-27T17:54:55.123' AS DATETIME),76 UNION ALL
SELECT 77,CAST('2020-02-26T17:54:55.123' AS DATETIME),77 UNION ALL
SELECT 78,CAST('2020-02-28T17:54:55.123' AS DATETIME),78 UNION ALL
SELECT 79,CAST('2020-02-27T17:54:55.123' AS DATETIME),79 UNION ALL
SELECT 80,CAST('2020-02-26T17:54:55.123' AS DATETIME),80 UNION ALL
SELECT 81,CAST('2020-02-28T17:54:55.123' AS DATETIME),81 UNION ALL
SELECT 82,CAST('2020-02-27T17:54:55.123' AS DATETIME),82 UNION ALL
SELECT 83,CAST('2020-02-26T17:54:55.123' AS DATETIME),83 UNION ALL
SELECT 84,CAST('2020-02-28T17:54:55.123' AS DATETIME),84 UNION ALL
SELECT 85,CAST('2020-02-27T17:54:55.123' AS DATETIME),85 UNION ALL
SELECT 86,CAST('2020-02-26T17:54:55.123' AS DATETIME),86 UNION ALL
SELECT 87,CAST('2020-02-28T17:54:55.123' AS DATETIME),87 UNION ALL
SELECT 88,CAST('2020-02-27T17:54:55.123' AS DATETIME),88 UNION ALL
SELECT 89,CAST('2020-02-26T17:54:55.123' AS DATETIME),89 UNION ALL
SELECT 90,CAST('2020-02-28T17:54:55.123' AS DATETIME),90 UNION ALL
SELECT 91,CAST('2020-02-27T17:54:55.123' AS DATETIME),91 UNION ALL
SELECT 92,CAST('2020-02-26T17:54:55.123' AS DATETIME),92 UNION ALL
SELECT 93,CAST('2020-02-28T17:54:55.123' AS DATETIME),93 UNION ALL
SELECT 94,CAST('2020-02-27T17:54:55.123' AS DATETIME),94 UNION ALL
SELECT 95,CAST('2020-02-26T17:54:55.123' AS DATETIME),95 UNION ALL
SELECT 96,CAST('2020-02-28T17:54:55.123' AS DATETIME),96 UNION ALL
SELECT 97,CAST('2020-02-27T17:54:55.123' AS DATETIME),97 UNION ALL
SELECT 98,CAST('2020-02-26T17:54:55.123' AS DATETIME),98 UNION ALL
SELECT 99,CAST('2020-02-28T17:54:55.123' AS DATETIME),99 UNION ALL
SELECT 100,CAST('2020-02-27T17:54:55.123' AS DATETIME),100

BeforeExecute
-- SqlServer.2005

SELECT
	[t].[BookingID],
	[t].[ServiceDate],
	[t].[Value]
FROM
	[Booking] [t]
WHERE
	[t].[ServiceDate] > DateAdd(day, -2, CAST('2020-02-29T17:54:55.123' AS DATETIME))
ORDER BY
	[t].[ServiceDate] DESC,
	[t].[BookingID] DESC

BeforeExecute
-- SqlServer.2005
DECLARE @take BigInt -- Int64
SET     @take = 12

SELECT
	[q].[TotalCount],
	[q].[RowNumber],
	[q].[BookingID],
	[q].[ServiceDate],
	[q].[Value_1]
FROM
	(
		SELECT
			ROW_NUMBER() OVER(ORDER BY [e].[ServiceDate] DESC, [e].[BookingID] DESC) as [RowNumber],
			COUNT(*) OVER() as [TotalCount],
			[e].[BookingID],
			[e].[ServiceDate],
			[e].[Value] as [Value_1]
		FROM
			[Booking] [e]
		WHERE
			[e].[ServiceDate] > DateAdd(day, -2, CAST('2020-02-29T17:54:55.123' AS DATETIME))
	) [q]
WHERE
	[q].[RowNumber] <= @take

BeforeExecute
-- SqlServer.2005
DECLARE @cursorValue Int -- Int32
SET     @cursorValue = 66
DECLARE @take Int -- Int32
SET     @take = 12

WITH [CTE_1]
(
	[Cursor_1],
	[RowNumber],
	[Data_ServiceDate],
	[Data_Value]
)
AS
(
	SELECT
		[e].[BookingID],
		ROW_NUMBER() OVER(ORDER BY [e].[ServiceDate] DESC, [e].[BookingID] DESC),
		[e].[ServiceDate],
		[e].[Value]
	FROM
		[Booking] [e]
	WHERE
		[e].[ServiceDate] > DateAdd(day, -2, CAST('2020-02-29T17:54:55.123' AS DATETIME))
)
SELECT
	[q].[RowNumber],
	[q].[Cursor_1],
	[q].[Data_ServiceDate],
	[q].[Data_Value]
FROM
	[CTE_1] [q]
WHERE
	EXISTS(
		SELECT
			*
		FROM
			[CTE_1] [c_1]
		WHERE
			[c_1].[Cursor_1] = @cursorValue AND [q].[RowNumber] > [c_1].[RowNumber] AND
			[q].[RowNumber] <= [c_1].[RowNumber] + @take
	)

BeforeExecute
-- SqlServer.2005
DECLARE @cursorValue Int -- Int32
SET     @cursorValue = 30
DECLARE @take Int -- Int32
SET     @take = 12

WITH [CTE_1]
(
	[Cursor_1],
	[RowNumber],
	[Data_ServiceDate],
	[Data_Value]
)
AS
(
	SELECT
		[e].[BookingID],
		ROW_NUMBER() OVER(ORDER BY [e].[ServiceDate] DESC, [e].[BookingID] DESC),
		[e].[ServiceDate],
		[e].[Value]
	FROM
		[Booking] [e]
	WHERE
		[e].[ServiceDate] > DateAdd(day, -2, CAST('2020-02-29T17:54:55.123' AS DATETIME))
)
SELECT
	[q].[RowNumber],
	[q].[Cursor_1],
	[q].[Data_ServiceDate],
	[q].[Data_Value]
FROM
	[CTE_1] [q]
WHERE
	EXISTS(
		SELECT
			*
		FROM
			[CTE_1] [c_1]
		WHERE
			[c_1].[Cursor_1] = @cursorValue AND [q].[RowNumber] > [c_1].[RowNumber] AND
			[q].[RowNumber] <= [c_1].[RowNumber] + @take
	)

BeforeExecute
-- SqlServer.2005
DECLARE @cursorValue Int -- Int32
SET     @cursorValue = 3
DECLARE @take Int -- Int32
SET     @take = 12

WITH [CTE_1]
(
	[Cursor_1],
	[RowNumber],
	[Data_ServiceDate],
	[Data_Value]
)
AS
(
	SELECT
		[e].[BookingID],
		ROW_NUMBER() OVER(ORDER BY [e].[ServiceDate] DESC, [e].[BookingID] DESC),
		[e].[ServiceDate],
		[e].[Value]
	FROM
		[Booking] [e]
	WHERE
		[e].[ServiceDate] > DateAdd(day, -2, CAST('2020-02-29T17:54:55.123' AS DATETIME))
)
SELECT
	[q].[RowNumber],
	[q].[Cursor_1],
	[q].[Data_ServiceDate],
	[q].[Data_Value]
FROM
	[CTE_1] [q]
WHERE
	EXISTS(
		SELECT
			*
		FROM
			[CTE_1] [c_1]
		WHERE
			[c_1].[Cursor_1] = @cursorValue AND [q].[RowNumber] > [c_1].[RowNumber] AND
			[q].[RowNumber] <= [c_1].[RowNumber] + @take
	)

BeforeExecute
-- SqlServer.2005

IF (OBJECT_ID(N'[Booking]', N'U') IS NOT NULL)
	DROP TABLE [Booking]

