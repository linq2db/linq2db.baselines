BeforeExecute
-- MySql MySql.Official MySql

CREATE TABLE `O1`
(
	`BplId`       INT          NOT NULL,
	`ChaveAcesso` VARCHAR(255)     NULL,
	`DocEntry`    INT          NOT NULL,
	`DocStatus`   VARCHAR(255)     NULL
)

BeforeExecute
-- MySql MySql.Official MySql

CREATE TABLE `O2`
(
	`BplId`       INT          NOT NULL,
	`ChaveAcesso` VARCHAR(255)     NULL,
	`DocEntry`    INT          NOT NULL,
	`DocStatus`   VARCHAR(255)     NULL
)

BeforeExecute
-- MySql MySql.Official MySql

CREATE TABLE `O3`
(
	`BplId`       INT          NOT NULL,
	`ChaveAcesso` VARCHAR(255)     NULL,
	`DocEntry`    INT          NOT NULL,
	`DocStatus`   VARCHAR(255)     NULL
)

BeforeExecute
-- MySql MySql.Official MySql

SELECT
	`t1`.`DescricaoStatus`,
	`t1`.`NumeroInterno`,
	`t1`.`StatusValor`
FROM
	(
		SELECT
			'Manual/Externo' as `DescricaoStatus`,
			`doSap`.`DocEntry` as `NumeroInterno`,
			CASE
				WHEN `doSap`.`DocStatus` = 'O'
					THEN 'Aberto'
				ELSE 'Fechado'
			END as `StatusValor`
		FROM
			`O1` `doSap`
		UNION
		SELECT
			'Manual/Externo' as `DescricaoStatus`,
			`doSap_1`.`DocEntry` as `NumeroInterno`,
			CASE
				WHEN `doSap_1`.`DocStatus` = 'O'
					THEN 'Aberto'
				ELSE 'Fechado'
			END as `StatusValor`
		FROM
			`O2` `doSap_1`
	) `t1`
UNION
SELECT
	'Manual/Externo',
	`doSap_2`.`DocEntry`,
	CASE
		WHEN `doSap_2`.`DocStatus` = 'O'
			THEN 'Aberto'
		ELSE 'Fechado'
	END
FROM
	`O3` `doSap_2`

BeforeExecute
-- MySql MySql.Official MySql

DROP TABLE `O3`

BeforeExecute
-- MySql MySql.Official MySql

DROP TABLE `O2`

BeforeExecute
-- MySql MySql.Official MySql

DROP TABLE `O1`

