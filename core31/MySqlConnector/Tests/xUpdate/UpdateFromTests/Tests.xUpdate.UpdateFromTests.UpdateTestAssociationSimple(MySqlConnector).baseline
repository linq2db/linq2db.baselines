BeforeExecute
-- MySqlConnector MySql

CREATE TABLE `UpdatedEntities`
(
	`RelationId` INT     NULL,
	`Value1`     INT NOT NULL,
	`Value2`     INT NOT NULL,
	`Value3`     INT NOT NULL,
	`id`         INT NOT NULL,

	CONSTRAINT `PK_UpdatedEntities` PRIMARY KEY CLUSTERED (`id`)
)

BeforeExecute
-- MySqlConnector MySql

INSERT INTO `UpdatedEntities`
(
	`RelationId`,
	`Value1`,
	`Value2`,
	`Value3`,
	`id`
)
VALUES
(0,1,1,3,0),
(1,11,12,13,1),
(2,21,22,23,2),
(3,31,32,33,3)

BeforeExecute
-- MySqlConnector MySql

CREATE TABLE `UpdateRelation`
(
	`RelatedValue1` INT NOT NULL,
	`RelatedValue2` INT NOT NULL,
	`RelatedValue3` INT NOT NULL,
	`id`            INT NOT NULL,

	CONSTRAINT `PK_UpdateRelation` PRIMARY KEY CLUSTERED (`id`)
)

BeforeExecute
-- MySqlConnector MySql

INSERT INTO `UpdateRelation`
(
	`RelatedValue1`,
	`RelatedValue2`,
	`RelatedValue3`,
	`id`
)
VALUES
(1,2,3,0),
(11,12,13,1),
(21,22,23,2),
(31,32,33,3)

BeforeExecute
-- MySqlConnector MySql

UPDATE
	`UpdatedEntities` `v`
		LEFT JOIN `UpdateRelation` `a_Relation` ON `v`.`RelationId` = `a_Relation`.`id`
SET
	`v`.`Value1` = `v`.`Value1` + `v`.`Value2` + `v`.`Value3`,
	`v`.`Value2` = `v`.`Value1` + `v`.`Value2` + `v`.`Value3`,
	`v`.`Value3` = 1
WHERE
	`a_Relation`.`RelatedValue1` = 11

BeforeExecute
-- MySqlConnector MySql
DECLARE @take Int32
SET     @take = 1

SELECT
	`v`.`Value1`,
	`v`.`Value2`,
	`v`.`Value3`
FROM
	`UpdatedEntities` `v`
		LEFT JOIN `UpdateRelation` `a_Relation` ON `v`.`RelationId` = `a_Relation`.`id`
WHERE
	`a_Relation`.`RelatedValue1` = 11
LIMIT @take

BeforeExecute
-- MySqlConnector MySql

DROP TABLE `UpdateRelation`

BeforeExecute
-- MySqlConnector MySql

DROP TABLE `UpdatedEntities`

